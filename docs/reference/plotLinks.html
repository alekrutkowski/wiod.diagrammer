<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Plot a diagram (directed graph) of top linkages — plotLinks â€¢ wiod.diagrammer</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>
  
  
<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">wiod.diagrammer</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Plot a diagram (directed graph) of top linkages</h1>
    </div>

    
    <p>Plot a diagram (directed graph) of top linkages</p>
    

    <pre class="usage"><span class='fu'>plotLinks</span>(<span class='no'>top_links_dt</span>, <span class='no'>wiot</span>, <span class='kw'>units</span> <span class='kw'>=</span> <span class='fu'>list</span>(<span class='kw'>units_suffix</span> <span class='kw'>=</span> <span class='st'>"bn USD"</span>,
  <span class='kw'>mln_USD_exchange_rate</span> <span class='kw'>=</span> <span class='fl'>0.001</span>),
  <span class='kw'>country_labels_dt</span> <span class='kw'>=</span> <span class='kw pkg'>wiod.diagrammer</span><span class='kw ns'>::</span><span class='fu'><a href='http://www.rdocumentation.org/packages/wiod.diagrammer/topics/countries'>countries</a></span>(),
  <span class='kw'>sector_labels_dt</span> <span class='kw'>=</span> <span class='kw pkg'>wiod.diagrammer</span><span class='kw ns'>::</span><span class='fu'><a href='http://www.rdocumentation.org/packages/wiod.diagrammer/topics/sectors'>sectors</a></span>(<span class='no'>wiot</span>),
  <span class='kw'>aggregates_dt</span> <span class='kw'>=</span> <span class='kw pkg'>wiod.diagrammer</span><span class='kw ns'>::</span><span class='fu'><a href='http://www.rdocumentation.org/packages/wiod.diagrammer/topics/aggregates'>aggregates</a></span>(<span class='no'>wiot</span>),
  <span class='kw'>arrowSizeFun</span> <span class='kw'>=</span> <span class='kw'>function</span>(<span class='no'>value</span>) <span class='kw pkg'>wiod.diagrammer</span><span class='kw ns'>:::</span><span class='fu'><a href='http://www.rdocumentation.org/packages/wiod.diagrammer/topics/normalise'>normalise</a></span>(<span class='no'>value</span>) * <span class='fl'>16</span> + <span class='fl'>1</span>,
  <span class='kw'>arrowLabelFun</span> <span class='kw'>=</span> <span class='no'>identity</span>, <span class='kw'>nodeSizeFun</span> <span class='kw'>=</span> <span class='kw'>function</span>(<span class='no'>country_sector_dt</span>)
  <span class='no'>country_sector_dt</span> <span class='kw'>%&gt;%</span> <span class='fu'>ifelse.</span>(<span class='no'>.</span>$<span class='no'>isFinal</span>, <span class='no'>.</span>$<span class='no'>II_fob</span>, <span class='no'>.</span>$<span class='no'>GO</span>),
  <span class='kw'>nodeSizeTransformFun</span> <span class='kw'>=</span> <span class='kw'>function</span>(<span class='no'>node_size_val</span>)
  <span class='kw pkg'>wiod.diagrammer</span><span class='kw ns'>::</span><span class='fu'><a href='http://www.rdocumentation.org/packages/wiod.diagrammer/topics/normalise'>normalise</a></span>(<span class='fu'>log</span>(<span class='no'>node_size_val</span>) + <span class='fl'>1</span>) * <span class='fl'>8</span> + <span class='fl'>8</span>,
  <span class='kw'>nodeLabelFun</span> <span class='kw'>=</span> <span class='kw'>function</span>(<span class='no'>country_sector_dt</span>) <span class='no'>country_sector_dt</span> <span class='kw'>%&gt;%</span>
  <span class='fu'>paste.</span>(<span class='no'>.</span>$<span class='no'>CountryLab</span>, <span class='no'>.</span>$<span class='no'>SectorLab</span>, <span class='fu'>paste</span>(<span class='no'>.</span>$<span class='no'>NodeSize</span> <span class='kw'>%&gt;%</span> <span class='no'>numberFormattingFun</span>,
  <span class='no'>units</span>$<span class='no'>units_suffix</span>), <span class='kw'>sep</span> <span class='kw'>=</span> <span class='st'>", "</span>),
  <span class='kw'>specificNodeOptionsFun</span> <span class='kw'>=</span> <span class='kw'>function</span>(<span class='no'>country_sector_dt</span>)
  <span class='fu'>ifelse</span>(<span class='no'>country_sector_dt</span>$<span class='no'>isFinal</span>, <span class='st'>"fontname=\"times-italic\""</span>, <span class='st'>""</span>),
  <span class='kw'>specificArrowOptionsFun</span> <span class='kw'>=</span> <span class='kw'>function</span>(<span class='no'>top_links_dt</span>)
  <span class='fu'>ifelse</span>(<span class='no'>top_links_dt</span>$<span class='no'>ExpCountry</span> <span class='kw'>==</span> <span class='no'>top_links_dt</span>$<span class='no'>ImpCountry</span>, <span class='st'>"style=solid"</span>,
  <span class='st'>"style=dashed"</span>), <span class='kw'>general_arrow_options</span> <span class='kw'>=</span> <span class='st'>"color=grey"</span>,
  <span class='kw'>general_node_options</span> <span class='kw'>=</span> <span class='st'>"shape=box"</span>, <span class='kw'>graph_options</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"layout=dot"</span>,
  <span class='st'>"rankdir=LR"</span>), <span class='kw'>numberFormattingFun</span> <span class='kw'>=</span> <span class='kw'>function</span>(<span class='no'>value</span>) <span class='no'>value</span> <span class='kw'>%&gt;%</span>
  <span class='fu'>formatC</span>(<span class='kw'>digits</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>format</span> <span class='kw'>=</span> <span class='st'>"f"</span>, <span class='kw'>big.mark</span> <span class='kw'>=</span> <span class='st'>" "</span>), <span class='kw'>nchar_wrap</span> <span class='kw'>=</span> <span class='fl'>30</span>,
  <span class='kw'>gvcode</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>top_links_dt</th>
      <td><p>A data.table returned by <code><a href='findLinks.html'>findLinks</a></code></p></td>
    </tr>
    <tr>
      <th>wiot</th>
      <td><p>WIOD data.table returned by <code><a href='loadWIOD.html'>loadWIOD</a></code></p></td>
    </tr>
    <tr>
      <th>units</th>
      <td><p>Optional: a list of two named interrelated elements:</p><dl class='dl-horizontal'>
  <dt><code>units_suffix</code></dt><dd><p>a string (character vector of length 1) with a name
  of the monetary units (default: <code>"bn USD"</code>). This element
  should be consistent with the next element <code>mln_USD_exchange_rate</code>!</p></dd>
  <dt><code>mln_USD_exchange_rate</code></dt><dd><p>a single value (numeric vector of length 1)
  by which the original WIOD numbers (which are in million US dollars) will be
  multiplied (default: <code>0.001</code>, so that the values become billion US dollars).
  This element should be consistent with the previous element <code>units_suffix</code>!</p></dd>
</dl></td>
    </tr>
    <tr>
      <th>country_labels_dt</th>
      <td><p>Optional: a <a href='http://www.rdocumentation.org/packages/data.table/topics/data.table'>data.table</a> with specific
columns -- see the documentation for <a href='countries.html'>countries</a> which is
the function called to produce the default value for <code>country_labels_dt</code>.
With this data.table, you may provide alternative (non-default) country names/labels
and/or additional country-level variables (columns) to be used by your (i.e. non-default)
functions for the arguments <code>nodeSizeFun</code>, <code>nodeLabelFun</code>, and
<code>specificNodeOptionsFun</code>.</p></td>
    </tr>
    <tr>
      <th>sector_labels_dt</th>
      <td><p>Optional: a <a href='http://www.rdocumentation.org/packages/data.table/topics/data.table'>data.table</a> with specific
columns -- see the documentation for <a href='sectors.html'>sectors</a> which is
the function called to produce the default value for <code>country_labels_dt</code>
With this data.table, you may provide alternative (non-default) sector names/labels
and/or additional sector-level variables (columns) to be used by your (i.e. non-default)
functions for the arguments <code>nodeSizeFun</code>, <code>nodeLabelFun</code>, and
<code>specificNodeOptionsFun</code>.</p></td>
    </tr>
    <tr>
      <th>aggregates_dt</th>
      <td><p>Optional: a <a href='http://www.rdocumentation.org/packages/data.table/topics/data.table'>data.table</a> with specific
columns -- see the documentation for <a href='aggregates.html'>aggregates</a> which is
the function called to produce the default value for <code>aggregates_dt</code>.
With this data.table, you may provide additional or alternative country-and-sector-level
variables (columns) to be used by your (i.e. non-default) functions for the arguments
<code>nodeSizeFun</code>, <code>nodeLabelFun</code>, and <code>specificNodeOptionsFun</code>.</p></td>
    </tr>
    <tr>
      <th>arrowSizeFun</th>
      <td><p>Optional: a one-numeric-argument function which translates
<code>top_links_dt</code>'s <code>value</code> column into GraphViz's <code>penwidth</code> values
for arrows (edges), see <a href='http://www.graphviz.org/content/attrs#dpenwidth'>http://www.graphviz.org/content/attrs#dpenwidth</a>).</p></td>
    </tr>
    <tr>
      <th>arrowLabelFun</th>
      <td><p>Optional: a one-numeric-argument function which translates
<code>top_links_dt</code>'s <code>value</code> column (multiplied by <code>units$mln_USD_exchange_rate</code>,
transformed by the <code>numberFormattingFun</code> function, and with <code>units_suffix</code>
pasted) into GraphViz's <code>label</code>s for arrows (edges). Default: identity.</p></td>
    </tr>
    <tr>
      <th>nodeSizeFun</th>
      <td><p>Optional: a function which takes a country-and-sector level
<a href='http://www.rdocumentation.org/packages/data.table/topics/data.table'>data.table</a> (including the columns of <code>aggregates_dt</code>) and returns
a numeric vector representing the sizes of the country-sector nodes (boxes).
Default: the value of 'output at basic prices' (<code>GO</code>) for the industrial sectors
(i.e. those that produce something -- goods or services)
and 'total intermediate consumption' (<code>II_fob</code>) for the final use sectors</p></td>
    </tr>
    <tr>
      <th>nodeSizeTransformFun</th>
      <td><p>Optional: a one-argument function which takes
the numeric value returned by the function <code>nodeSizeFun</code> and translates it
into GraphViz's <code>fontsize</code> values for the country-sector nodes (boxes), see
<a href='http://www.graphviz.org/content/attrs#dfontsize'>http://www.graphviz.org/content/attrs#dfontsize</a>).</p></td>
    </tr>
    <tr>
      <th>nodeLabelFun</th>
      <td><p>Optional: a function which takes the country-and-sector-level
<a href='http://www.rdocumentation.org/packages/data.table/topics/data.table'>data.table</a> -- a merger of <code>aggregates_dt</code>,
<code>country_labels_dt</code>, and <code>sector_labels_dt</code> for the country-sector combinations
present in <code>top_links_dt</code> -- and returns a character vector used as GraphViz's
<code>label</code>s for nodes (boxes). If the function needs to refer to the node size
(produced by the function <code>nodeSizeFun</code>) it should refer to data.table's column
<code>NodeSize</code>. Default: it returns, for each node, the following
components pasted together: country label, sector label, a value returned by
<code>nodeSizeFun</code> and the <code>units$units_suffix</code>.</p></td>
    </tr>
    <tr>
      <th>specificNodeOptionsFun</th>
      <td><p>Optional: a function which takes the country-and-sector-level
<a href='http://www.rdocumentation.org/packages/data.table/topics/data.table'>data.table</a> and returns a character vector of GraphViz's node attributes*,
see ** with 'node' highlighted in
the 'COMPONENTS' section. Default: <code>'fontname="times-italic"'</code> for the final
use sectors (such as final consumption or investment).</p></td>
    </tr>
    <tr>
      <th>specificArrowOptionsFun</th>
      <td><p>Optional: a function which takes <code>top_links_dt</code>
as an argument and returns a character vector of GraphViz's edge attributes*,
see ** with 'edge' highlighted in
the 'COMPONENTS' section. Default: <code>'style=solid'</code> for the domestic flows and
'style=dashed' for the international flows.</p></td>
    </tr>
    <tr>
      <th>general_arrow_options</th>
      <td><p>Optional: a character constant (vector of length 1) with the GraphViz's edge
global attributes* of all the arrows (edges)
see ** with 'edge' highlighted in
the 'COMPONENTS' section. . Default: <code>'color=grey'</code>.</p></td>
    </tr>
    <tr>
      <th>general_node_options</th>
      <td><p>Optional: a character constant (vector of length 1) with the GraphViz's edge
global attributes* of all the nodes (country-sector boxes)
see ** with 'node' highlighted in
the 'COMPONENTS' section. Default: <code>'shape=box'</code>.</p></td>
    </tr>
    <tr>
      <th>graph_options</th>
      <td><p>Optional: character constant (vector of length 1) with the GraphViz's edge
global attributes* of the whole graph.
See ** with 'graph' highlighted in the 'COMPONENTS' section.
Default: <code>c('layout=dot', 'rankdir=LR')</code>.
For the 'layout' see <a href='https://en.wikipedia.org/wiki/Graphviz#Software_architecture'>https://en.wikipedia.org/wiki/Graphviz#Software_architecture</a>;
'rankdir' is applicable only if <code>'layout=dot'</code>, <code>LR</code> = left-to-right,
<code>TB</code> = top-to-bottom.</p></td>
    </tr>
    <tr>
      <th>numberFormattingFun</th>
      <td><p>Optional: a one-numeric-argument function used to format all
the numbers displayed in the graph. Default: it returns a character vector with values
formated as one digit after decimal dot and blank as a digit-grouping separator.</p></td>
    </tr>
    <tr>
      <th>nchar_wrap</th>
      <td><p>Optional: a numeric constant -- the number of characters arounnd which the text
of arrow labels (returned by <code>arrowLabelFun</code>) is wraped into another line.
Default: 30.</p></td>
    </tr>
    <tr>
      <th>gvcode</th>
      <td><p>Optional: should the generated GraphViz code be returned instead
of the <code><a href='http://www.rdocumentation.org/packages/DiagrammeR/topics/grViz'>grViz</a></code> object (logical)? This is useful for debugging.
Default: FALSE.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>The return value of <code><a href='http://www.rdocumentation.org/packages/DiagrammeR/topics/grViz'>grViz</a></code> or the Graphviz code
if <code>gvcode = TRUE</code>.</p>
    
    <h2 class="hasAnchor" id="footnotes"><a class="anchor" href="#footnotes"></a>Footnotes</h2>

    
    <p>* in the form of comma-separate key=value pairs:
<code>'attribute_name_1 = attribute_value_1, attribute_name_2 = attribute_value_2, ...'</code></p>
<p>** <a href='http://www.graphviz.org/doc/schema/attributes.xml'>http://www.graphviz.org/doc/schema/attributes.xml</a></p>
    

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#footnotes">Footnotes</a></li>
          </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by <a href="mailto:alek.rutkowski@gmail.com?subject=wiod.diagrammer">Aleksander Rutkowski</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>